<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Multiplayer Poker</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="app">
        <div id="debug-log"
            style="position:fixed; top:0; left:0; width:100%; max-height:80px; background:rgba(255,0,0,0.9); color:white; z-index:9999; overflow:auto; display:none; font-size:11px; padding:5px;">
        </div>
        <script>
            window.addEventListener('error', (e) => {
                const d = document.getElementById('debug-log');
                d.style.display = 'block';
                d.innerText += "Error: " + e.message + " at " + e.filename + ":" + e.lineno + "\n";
            });
            window.addEventListener('unhandledrejection', (e) => {
                const d = document.getElementById('debug-log');
                d.style.display = 'block';
                d.innerText += "Promise Error: " + e.reason + "\n";
            });
        </script>

        <!-- Lobby Screen -->
        <div id="lobby" class="screen active">
            <h1>Poker Room</h1>
            <div class="lobby-controls">
                <div class="player-select">
                    <label for="player-count">Players:</label>
                    <select id="player-count">
                        <option value="2">2 Players</option>
                        <option value="3">3 Players</option>
                        <option value="4">4 Players</option>
                        <option value="5">5 Players</option>
                        <option value="6">6 Players</option>
                    </select>
                </div>

                <div class="player-identity">
                    <input type="text" id="player-name" list="saved-names" placeholder="Your Name (Optional)"
                        maxlength="12">
                    <datalist id="saved-names"></datalist>
                    <label class="save-check">
                        <input type="checkbox" id="save-name-default" checked> Save name
                    </label>
                </div>

                <button id="btn-create">Create Room</button>
                <div class="join-form">
                    <input type="text" id="inp-room-code" placeholder="Enter Room Code" maxlength="6">
                    <button id="btn-join">Join Room</button>
                </div>
            </div>
            <p class="status-msg" id="lobby-msg"></p>
        </div>

        <!-- Game Screen -->
        <div id="game" class="screen">
            <div class="header">
                <div class="room-info">Room: <span id="display-room-code"></span> | <span
                        id="player-count-display"></span></div>
                <div class="pot-info">Pot: <span id="pot-amount">0</span></div>
            </div>

            <!-- Opponents Container (scrollable for 3+ players) -->
            <div id="opponents-container">
                <!-- Dynamic opponent areas will be injected here -->
            </div>

            <!-- Board / Community Cards -->
            <div id="board">
                <div class="card-slot"></div>
                <div class="card-slot"></div>
                <div class="card-slot"></div>
                <div class="card-slot"></div>
                <div class="card-slot"></div>
            </div>

            <!-- Player Area (Me - Bottom) -->
            <div id="player-area" class="player-area me">
                <div class="bet-chip" id="player-bet"></div>
                <div class="status-bubble" id="player-status"></div>
                <div class="cards" id="player-cards"></div>
                <div class="player-info">
                    <div class="avatar">ME</div>
                    <div class="details">
                        <span class="name">You</span>
                        <span class="chips">$1000</span>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div id="controls">
                <div class="action-bar">
                    <button class="btn-action fold" data-action="fold">Fold</button>
                    <button class="btn-action check" data-action="check">Check</button>
                    <button class="btn-action call" data-action="call">Call</button>
                    <button class="btn-action raise" data-action="raise">Raise</button>
                </div>
                <div class="slider-container" id="raise-slider-container" style="display:none;">
                    <input type="range" id="raise-slider" min="0" max="1000" step="1">
                    <input type="number" id="raise-val" value="0" min="0">
                    <button id="btn-confirm-raise">Bet</button>
                </div>
            </div>

            <div id="game-overlay" class="overlay" style="display:none;">
                <div class="overlay-content">
                    <h2 id="overlay-msg">You Win!</h2>
                    <button id="btn-next-hand">Next Hand</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Music Player -->
    <div id="music-player">
        <div class="track-info">
            <span id="track-name">No Track</span>
        </div>
        <div class="controls">
            <button id="btn-prev">‚èÆ</button>
            <button id="btn-play">‚ñ∂</button>
            <button id="btn-next">‚è≠</button>
        </div>
        <div class="volume-control">
            <span>üîä</span>
            <input type="range" id="volume-slider" min="0" max="1" step="0.1" value="0.5">
        </div>
        <audio id="bg-audio"></audio>
    </div>

    <script type="module" src="game.js"></script>
</body>

</html>